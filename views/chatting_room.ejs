<!-- 상담 채팅 방 페이지 -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>상담 채팅 방</title>
</head>

<body>
    상담 채팅 방
    <br>
    ID :
    <input type="text" value="<%= create_room_data.id %>" readonly>
    <br>
    방 생성자 타입:
    <input type="text" value="<%= create_room_data.room_creator_type %>">
    <br>
    제목 :
    <input type="text" value="<%= create_room_data.room_title %>">
    <br>
    상담 타입:
    <input type="text" value="<%= create_room_data.counsel_type %>">
    <br>
    <button id="delete_room_button">나가기</button>


</body>
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script>
<script>
(jQuery)(function($) {

        var host='localhost';
        var port='3000';
        var url='http://'+host+':'+port;
        var options={'forceNew':true};
        var socket=io.connect(url, options);

        socket.on('connect', function(){
            console.log('웹 소켓 서버에 연결되었습니다. : '+url);
        });

        socket.on('disconnect', function(){
            console.log('웹 소켓 연결이 종료되었습니다.');
        });


        var output = {command:'create', room_creator_id:'<%= create_room_data.id %>', room_title:'<%= create_room_data.room_title %>',
                        counsel_type:'<%= create_room_data.counsel_type %>', room_creator_type:'<%= create_room_data.room_creator_type %>'};

        console.log('서버로 보낼 데이터 : ' + JSON.stringify(output));

        if(socket==undefined){
            alert('서버에 연결되어 있지 않습니다. 먼저 서버에 연결하세요.');
            return;
        }

        socket.emit('room', output);

        $('#delete_room_button').on('click', function(){

            var output = {command:'delete', room_creator_id:'<%= create_room_data.id %>'};

            console.log('서버로 보낼 데이터 : ' + JSON.stringify(output));

            if(socket==undefined){
                alert('서버에 연결되어 있지 않습니다. 먼저 서버에 연결하세요.');
                return;
            }

            socket.emit('room', output);
        });

});
</script>
</html>
